legend("bottomleft","(y,x)",legend=c("a1","a2","a3","a4","a5"),lty=2:6)
plot(row, a1,"l",lty=2, main="compare five methods", xlab="row number", ylab="harvest")
par(new=TRUE)
plot(row, a2,lty=3,main=NA,xlab=NA,ylab=NA)
par(new=TRUE)
plot(row, a3,"l",lty=4,main=NA,xlab=NA,ylab=NA)
par(new=TRUE)
plot(row, a4,"l",lty=5,main=NA,xlab=NA,ylab=NA)
par(new=TRUE)
plot(row, a5,"l",lty=6,main=NA,xlab=NA,ylab=NA)
points(row,y)
legend("bottomleft",legend=c("a1","a2","a3","a4","a5"),lty=2:6)
plot(row, a1,"l",lty=2, main="compare five methods", xlab="row number", ylab="harvest")
par(new=TRUE)
plot(row, a2,lty=3,main=NA,xlab=NA,ylab=NA,color=2)
par(new=TRUE)
plot(row, a3,"l",lty=4,main=NA,xlab=NA,ylab=NA,color=3)
par(new=TRUE)
plot(row, a1,"l",lty=2, main="compare five methods", xlab="row number", ylab="harvest")
par(new=TRUE)
plot(row, a2,"l",lty=3,main=NA,xlab=NA,ylab=NA,color=2)
legend("bottomleft",legend=c("a1","a2","a3","a4","a5"),colors=1:5)
plot(row, a1,"l",lty=2, main="compare five methods", xlab="row number", ylab="harvest")
par(new=TRUE)
plot(row, a2,"l",lty=3,main=NA,xlab=NA,ylab=NA,colors=2)
plot(row, a2,"l",lty=3,main=NA,xlab=NA,ylab=NA,colors="red")
plot(row, a1,"l",lty=2, main="compare five methods", xlab="row number", ylab="harvest")
par(new=TRUE)
plot(row, a2,"l",lty=3,main=NA,xlab=NA,ylab=NA,colors="red")
par(new=TRUE)
plot(row, a3,"l",lty=4,main=NA,xlab=NA,ylab=NA,colors=3)
par(new=TRUE)
plot(row, a4,"l",lty=5,main=NA,xlab=NA,ylab=NA,colors=4)
par(new=TRUE)
plot(row, a5,"l",lty=6,main=NA,xlab=NA,ylab=NA,colors=5)
points(row,y)
x=matrix(c(1,1,1,1,1,-.63,.18,-/84,1.6,.33,-.82,.49,.74,.58,-.31),c(3,5))
x=matrix(c(1,1,1,1,1,-.63,.18,-.84,1.6,.33,-.82,.49,.74,.58,-.31),c(3,5))
x
x=matrix(c(1,1,1,1,1,-.63,.18,-.84,1.6,.33,-.82,.49,.74,.58,-.31),c(5,3))
x
y=matrix(c(-.97,2.51,-.19,6.53,1),c(5,1))
y
t(x)%*%x
t(x)%*%y
solve(t(x)%*%x)
p=solve(t(x)%*%x)
q=t(x)%*%y
p%*%q
q=t(x)%*%x
x%*%P%*%t(x)
x%*%p%*%t(x)
library("MATRIX")
library("matrix")
require("matrix")
rankmatrix(h)
h=x%*%p%*%t(x)
install.packages("matrix")
library("Matrix", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
rankmatrix(h)
rankMatrix(h)
rankMatrix(I-h)
matrix(I)
I=diag(3)
I
I=diag(5)
rankMatrix(I-h)
h
I=diag(3) p=solve(t(x)%*%x)
> q=t(x)%*%y
> p%*%q
p=solve(t(x)%*%x)
> q=t(x)%*%y
> p%*%q
p=solve(t(x)%*%x)
q=t(x)%*%y
p%*%q
p=solve(t(x)%*%x)
q=t(x)%*%y
b= p%*%q
b
yhat=x%*%b
yhat
y-yhat
sum((y-yhat)^2)
sum((y-yhat)^2)/3
mse=sum((y-yhat)^2)/3
p=solve(t(x)%*%x)
p*mse
sqrt(0.064362708)
sqrt(0.088514115)
sqrt(0.18300942)
xx
xx=cbind(x,c(-.63*-.82,.18*.49,-.84*.74,1.6*.58,.33*-.31))
xx
yy=y
xx%*%(solve(t(xx)%*%xx))%*%t(xx)
hh=xx%*%(solve(t(xx)%*%xx))%*%t(xx)
rankMatrix(hh)
rankMatrix(hh)
yyhat=(solve(t(xx)%*%xx))%*%t(xx)%*%yy
bb=(solve(t(xx)%*%xx))%*%t(xx)%*%yy
bb
xx%*%bb
yyhat=xx%*%bb
yy-yyhat
ee=yy-yyhat
sum(ee^2)
sum(ee^2)/4
ã€‚36*2.14
.36*2.14
.66*.74
.66*1.91
.52*.51
.52*.41
xx=matrix(c(.087,-.014,.035,.004,-.014,.115,-.012,-.052,-.035,-.012,.057,-.014,-.004,-.052,-.014,.05),c(4,4))
xx
xx[3,1]=-xx[3,1]
xx[4,1]=-xx[4,1]
xx
xh=matrix(c(1,0,0,0),c(4,1))
xh
t(xh)%*%xx%*%xh
1:2
50:2.5
1.02^2
1.02^2*(1.087)
pt(0.975,26)
p=pt(0.975,26)
0.9918-p*1.130915
0.9918+p*1.130915
58.232+5.49+.448
58.232+5.49+.448
58.232+5.49+.44+27.48
ssto=91.642
ssto-58.232
5.49+0.448
58.232+5.49
ssto-63.722
matrix(c(1,2,3,4,5,6),c(3,2))
a=matrix(c(1,2,3,4,5,6),c(3,2))
solve(a)
1.0404*(1+0.087)
pt(0.975,26)
pt(.999,82)
qt(.999,82)
qt(.995,82)
27.048+.448+5.49
5.49+.448
a=5.49+.448
a=a/2
a/(27.048/26)
df(1,28)
pf(1,28)
qf(1,28)
qf(0,1,28)
qf(1,1,28)
qf(0,1,28)
pvalue()
?pvalue
??pvalue
?pf
qf(1-.01,2,26)
sqrt(1.0404*1.087)
sqrt(1.04*1.087)
0.9918-2.055529*1.063445
0.9918+2.055529*1.063445
100-10
77.382-21.818
.753/.98
.753/.9855
install.packages("patchDVI")
library("knitr", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
choose(3,2)
choose(4,2)
choose(7,2)*(1/3)^2*(2/3)^5
choose(7,3)*(1/3)^3*(2/3)^4
choose(7,2)
choose(7,3)
choose(7,2)*(2/3)^2*(1/3)^5
choose(7,3)*(2/3)^3*(1/3)^4
e
??e
exp(-0.3)
exp(-0.3)*1.3
exp(-3.125)*(3.125^2/2)
exp(-3.125)*(3.125^3/6)
exp(-3.125)*(3.125^4/24)
0.2145+.2234+.1745
a=exp(-3.125)*(3.125^2/2)
b=exp(-3.125)*(3.125^3/6)
c=exp(-3.125)*(3.125^4/24)
a+b+c
exp(-2)*(28/3)
exp(-2)*(4)
extractAIC(fit, k=log(n))
fit2 = lm(Y~X1+ X2+ X4, data=data)
fds
llfdsf
a=1:3
names(a)=c("a","b","c")
match("a",a)
match("a",names(a))
match("c",names(a))
?sprintf
n <- 1:18
sprintf(paste0("e with %2d digits = %.", n, "g"), n, exp(1))
sprintf("min 10-char string '%10s'",
c("a", "ABC", "and an even longer one"))
sprintf("fuck","you")
sprintf("fuck",c("you"))
sprintf("fuck",c("you","fukc you"))
sprintf("fuck",c("you","fukc youffds"))
sprintf("fuck",c("you","fukc youffds,asd"))
sprintf("fuck",c("you","fukc youffds,asd,"fsd))
sprintf("fuck",c("you","fukc youffds,asd,"fsd""))
sprintf("fuck",c("you","fukc youffds,asd,"fsd"))
sprintf("fuck",c("you","fukc youffds,asd","fsd"))
sprintf("--%s",c("you","fukc youffds,asd","fsd"))
sprintf("asd",c("you","fukc youffds,asd","fsd"))
sprintf("qqw",c("you","fukc youffds,asd","fsd"))
sprintf("\n",c("you","fukc youffds,asd","fsd"))
grep("fuc","fuck",value=T)
grep("fuc","fuck",value=TRUE)
?rpart
??rpart
install.packages("rpart")
library("rpart", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
mse = 2.125
sd = sqrt(2*mse/(2*1))
B = qt(1-0.05/(2*3),(4-1)*(2-1))
d1 = 6 -0
d2 = 13.5-6
d3 = 16-13.5
c(d1-sd*B,d1+sd*B)
c(d2-sd*B,d2+sd*B)
c(d3-sd*B,d3+sd*B)
B
S = sqrt((4-1)*qf(1-0.05,3,3))
L = (0+6)/2-(13.5+16)/2
Sl = sqrt(mse/8*(4))
c(L-Sl*S, L+Sl*S)
S
S = sqrt((4-1)*qf(1-0.05,3,3))
S
L = (0+6)/2-(13.5+16)/2
Sl = sqrt(mse)
c(L-Sl*S, L+Sl*S)
\qquad Therefore, the 95\% interval is [-19.440156, -4.059844].
\item
eyeC = read.table("eye-contact.txt", header = TRUE)
fit = lm(score ~ factor(gender) + factor(contact) + I(gender*contact) , eyeC)
fit$fit
fit$resid
plot(fit, which = 2)
plot(fit, which = 1)
mu11 = mean(subset(invest$score, invest$A==1)) + mean(subset(invest$score, invest$B==1))-mean(invest$score)
t = qt(1-0.05/2, 3)
s = sqrt(mse/1)
scale
??scale
setwd("~/Course/2015winter/stat 207/hw/hw2")
sod = read.table("CH25PR07.txt")
sod = read.table("CH25PR07.txt")
sod
sod = read.table("CH25PR07.txt")
names(sod) = c("Y", "X1", "X2")
sod
names(sod) = c("Y", "A", "B")
fit = lm(Y ~ factor(A) + factor(B) + factor(A*B), data = sod)
summary(fit)
fit = lm(Y ~ A+B+I(A*B), data = sod)
summary(fit)
anova(fit)
fit = lm(Y ~ factor(A) + factor(B) + factor(I(A*B)), data = sod)
anova(fit)
fit = lm(Y ~ factor(A) + factor(B), data = sod)
anova(fit)
fit = lm(Y ~ factor(A), data = sod)
anova(fit)
qf(1-0.01,5,42)
summary(fit)
mean(sod$Y)
sqrt(0.716/48)
sqrt(170.906/48)
qt(0.995,5)
f_low = qf(0.005, 5, 42)
f_low
f_high = qf(0.995, 5, 42)
l = 1/n*(f_star/f_low - 1)
u = 1/n*(f_star/f_high - 1)
f_star = 238.71
l = 1/n*(f_star/f_low - 1)
u = 1/n*(f_star/f_high - 1)
l
f_star
f_star/f_low
f_star/f_low-1
n = 8
l = 1/n*(f_star/f_low - 1)
u = 1/n*(f_star/f_high - 1)
l
f_high = qf(0.995, 5, 42)
f_high
u
L_star = l/(l+1)
U_star = u/(u+1)
c(L_star, U_star)
u = 1/n*(f_star/f_low - 1)
l = 1/n*(f_star/f_high - 1)
L_star = l/(l+1)
U_star = u/(u+1)
c(L_star, U_star)
summary(fit)
anova(fit)
(170.906-0.716)/8
?chi
??chi
?qf
?qchi
??qchi
x1 = qchisq(0.005, 42)
x2 = qchisq(0.995, 42)
x1
an = anova(fit)
an
c(30.07/x2, 30.07/x1)
170.906/3/0.716
170.906/17/0.716
F1=qf(.995,5,Inf)
F1
G1=1/F1
G2=1/F2
G3=((F5-1)^2-(G1F5)^2-(F4-1)^2)/F5
F1=qf(.995,5,Inf)
F2=qf(.995,42,Inf)
F3=qf(.995,Inf,5)
F4=qf(.995,Inf,42)
F5=qf(.995,5,42)
F6=qf(.995,42,5)
G1=1/F1
G2=1/F2
G3=((F5-1)^2-(G1F5)^2-(F4-1)^2)/F5
G1
G1=1-1/F1
G2=1-1/F2
G3=((F5-1)^2-(G1*F5)^2-(F4-1)^2)/F5
G1
G2
F2
G3
G4=F6*( ((F6-1)/F6)^2 - ((F3-1)/F6)^2 - G2^2 )
G4
ms1=170.906
ms2=0.716
Hl = sqrt( (G1*c1*ms1)^2 + ((F4-1)*c2*ms2)^2 - G3*c1*c2*ms1*ms2)
c1=0.125
c2=-.125
Hl = sqrt( (G1*c1*ms1)^2 + ((F4-1)*c2*ms2)^2 - G3*c1*c2*ms1*ms2)
Hl
Hu = sqrt( (G2*c2*ms2)^2 + ((F3-1)*c1*ms1)^2 - G4*c1*c2*ms1*ms2)
Hu
sigma_mu = 21.27375
c(sigma_mu-Hl, sigma_mu+Hu)
disk = read.table("CH19PR16.txt")
disk
dat = read.table('CH19PR16.txt')
names(dat) = c('y', 'A', 'B', 'k')
dat$A = as.factor(dat$A)
dat$B = as.factor(dat$B)
a = length(unique(dat$'A'))
b = length(unique(dat$'B'))
n = length(unique(dat$'k'))
@
n
a
b
model = aov(y ~ B + Error(A*B), data = dat)
summary(model)
303.8/52.01
qf(0.01,4,36)
pf(0.01,4,36)
qf(1-0.01,4,36)
pf(3.890308,4,36)
pf(303.8/52.01,4,36)
1-pf(303.8/52.01,4,36)
pf(303.8/52.01,4,36,lower.tail = FALSE)
(303.8 -52.01)/5
model.avo
summary(model)
12.29/52.01
qf(0.99,2,36)
14.16/303.8
qf(0.99,2,4)
dat_j1 = dat[B == 1]
dat_j1
means = with(dat, by(y, B, mean))
means
means[1]
means_j = with(dat, by(y, B, mean))
means_j
s = sqrt(MSAB/(n*a)*(1+1))
MSAB = 303.8
s = sqrt(MSAB/(n*a)*(1+1))
s
MSAB = 303.822
s
s = sqrt(MSAB/(n*a)*(1+1))
s
means_j = with(dat, by(y, B, mean))
means_j
D1 = means_j[1]-means_j[2]
D2 = means_j[1]-means_j[3]
D3 = means_j[2]-means_j[3]
MSAB = 303.8
s = sqrt(MSAB/(n*a)*(1+1))
alpha = .05
q. = qtukey(1-alpha, b, (a-1)*(b-1))
c(D1-s*q., D1+s*q.)
c(D2-s*q., D2+s*q.)
c(D3-s*q., D3+s*q.)
D1
D2
means_j
q.
s*q.
q. = 1/sqrt(2)*qtukey(1-alpha, b, (a-1)*(b-1))
q.
c(D1-s*q., D1+s*q.)
c(D2-s*q., D2+s*q.)
c(D3-s*q., D3+s*q.)
D1
D2
D3
s = sqrt(MSAB/(n*a)*(1+1))
s
q.
c(D1-s*q., D1+s*q.)
c(D2-s*q., D2+s*q.)
c(D3-s*q., D3+s*q.)
summary.aov
summary.aov(model)
summary(model)
mu_j1 = means_j[1]
MSA = 12.29
MSAB = 303.8
c1 = (a-1)/(n*a*b)
c2 = 1/(n*a*b)
s = sqrt(c1*MSAB+c2*MSA)
df = s^2/( (c1*MSAB)^2/((a-1)*(b-1))+ (c2*MSA)^2/((a-1)))
s
df
c1
c2
2/45
s^2
df = s^4/( (c1*MSAB)^2/((a-1)*(b-1))+ (c2*MSA)^2/((a-1)))
df
t = qt(1-0.01/2,(df))
t
c(mu_j1-s*t, mu_j1+s*t)
df
q
t
b
n
1/15
c1=1/15
c2=-1/15
ms1=12.29
ms2=52.01
df1=2
df2=36
F1=qf(.995,2,Inf)
F2=qf(.995,36,Inf)
F3=qf(.995,Inf,2)
F4=qf(.995,Inf,36)
F5=qf(.995,2,36)
F6=qf(.995,36,2)
G1=1-1/F1
G2=1-1/F2
G3=((F5-1)^2-(G1*F5)^2-(F4-1)^2)/F5
G4=F6*( ((F6-1)/F6)^2 - ((F3-1)/F6)^2 - G2^2 )
Hl = sqrt( (G1*c1*ms1)^2 + ((F4-1)*c2*ms2)^2 - G3*c1*c2*ms1*ms2)
Hl
Hu = sqrt( (G2*c2*ms2)^2 + ((F3-1)*c1*ms1)^2 - G4*c1*c2*ms1*ms2)
Hu
sigma_mu =  (ms1-ms2)/(n*b)
c(sigma_mu-Hl, sigma_mu+Hu)
sigma_mu
c1=1/15
c2=-1/15
ms1=12.29
ms2=52.01
df1=2
df2=36
F1=qf(.995,2,Inf)
F2=qf(.995,36,Inf)
F3=qf(.995,Inf,2)
F4=qf(.995,Inf,36)
F5=qf(.995,2,36)
F6=qf(.995,36,2)
G1=1-1/F1
G2=1-1/F2
G3=((F5-1)^2-(G1*F5)^2-(F4-1)^2)/F5
G4=F6*( ((F6-1)/F6)^2 - ((F3-1)/F6)^2 - G2^2 )
Hl = sqrt( (G1*c1*ms1)^2 + ((F4-1)*c2*ms2)^2 - G3*c1*c2*ms1*ms2)
Hl
Hu = sqrt( (G2*c2*ms2)^2 + ((F3-1)*c1*ms1)^2 - G4*c1*c2*ms1*ms2)
Hu
sigma_mu =  (ms1-ms2)/(n*b)
c(max(0,0-Hl), 0+Hu)
